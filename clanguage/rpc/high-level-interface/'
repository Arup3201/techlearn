// rls.c - remote procedure call client

#include "rls.h"
#include <rpc/rpc.h>

void read_dir_clnt(char*, char*);

int main(int argc, char* argv[]) {
	if(argc != 3) {
		fprintf(stderr, "usage: %s host dirname", argv[0]);
		return 0;
	}

	read_dir_clnt(argv[1], argv[2]);
	return 1;
}

void read_dir_clnt(char* host, char* dir) {
	extern bool_t xdr_dir(XDR*, char*);
	fprintf(stdout, "Trying to search %s directory\n", dir);

	enum clnt_stat cs;
	char *result;
	cs = callrpc(host, READDIR_PROG, READDIR_VERS, READDIR_PROC, (xdrproc_t)xdr_dir, &dir, (xdrproc_t)xdr_dir, &result);
	if(cs != 0) {
		clnt_perrno(cs);
		return;
	}

	fprintf(stdout, "%s", result);
}
